<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eatech Admin Dashboard - Control Center</title>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#FF6B6B">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    
    <!-- Chart.js fÃ¼r Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Auth Check -->
    <script src="js/auth-check.js"></script>
    
    <style>
        /* Theme Variables - Identical to Main Site */
        :root {
            /* Noir Excellence (Default) */
            --primary: #FF6B6B;
            --primary-dark: #FF5252;
            --secondary: #4ECDC4;
            --dark: #2C3E50;
            --darker: #1a1a2e;
            --light: #F7F9FB;
            --text: #E8E8E8;
            --text-muted: #95A5A6;
            --success: #2ECC71;
            --warning: #F39C12;
            --danger: #E74C3C;
            --info: #3498DB;
            --card-bg: #16213e;
            --sidebar-bg: #0f1419;
            --gradient-start: #0f0f1e;
            --gradient-end: #1a1a2e;
            --header-bg: rgba(26, 26, 46, 0.95);
            --nav-bg: #16213e;
            --border-accent: #FF6B6B;
            --input-bg: #1a1a2e;
        }

        /* Theme Definitions */
        [data-theme="midnight-purple"] {
            --primary: #9B59B6;
            --primary-dark: #8E44AD;
            --secondary: #3498DB;
            --card-bg: #2C2C54;
            --sidebar-bg: #1E1E3A;
            --gradient-start: #1E1E3A;
            --gradient-end: #2C2C54;
            --header-bg: rgba(44, 44, 84, 0.95);
            --nav-bg: #2C2C54;
            --border-accent: #9B59B6;
            --input-bg: #3A3A6A;
        }

        [data-theme="forest-green"] {
            --primary: #27AE60;
            --primary-dark: #229954;
            --secondary: #F39C12;
            --card-bg: #1D3E2C;
            --sidebar-bg: #14281D;
            --gradient-start: #0A1612;
            --gradient-end: #1D3E2C;
            --header-bg: rgba(29, 62, 44, 0.95);
            --nav-bg: #1D3E2C;
            --border-accent: #27AE60;
            --input-bg: #2A5940;
        }

        [data-theme="ocean-blue"] {
            --primary: #3498DB;
            --primary-dark: #2980B9;
            --secondary: #E74C3C;
            --card-bg: #1C2E4A;
            --sidebar-bg: #152238;
            --gradient-start: #0C1929;
            --gradient-end: #1C2E4A;
            --header-bg: rgba(28, 46, 74, 0.95);
            --nav-bg: #1C2E4A;
            --border-accent: #3498DB;
            --input-bg: #2A3F5F;
        }

        [data-theme="sunset-orange"] {
            --primary: #E67E22;
            --primary-dark: #D35400;
            --secondary: #9B59B6;
            --card-bg: #3E2723;
            --sidebar-bg: #2E1A1A;
            --gradient-start: #1A0E0E;
            --gradient-end: #3E2723;
            --header-bg: rgba(62, 39, 35, 0.95);
            --nav-bg: #3E2723;
            --border-accent: #E67E22;
            --input-bg: #5D3A35;
        }

        [data-theme="royal-gold"] {
            --primary: #F1C40F;
            --primary-dark: #F39C12;
            --secondary: #9B59B6;
            --card-bg: #3D3A2B;
            --sidebar-bg: #2A2817;
            --gradient-start: #1A180F;
            --gradient-end: #3D3A2B;
            --header-bg: rgba(61, 58, 43, 0.95);
            --nav-bg: #3D3A2B;
            --border-accent: #F1C40F;
            --input-bg: #5A5642;
        }

        [data-theme="deep-space"] {
            --primary: #0080FF;
            --primary-dark: #0066CC;
            --secondary: #FF0080;
            --card-bg: #001428;
            --sidebar-bg: #000A14;
            --gradient-start: #000000;
            --gradient-end: #001428;
            --header-bg: rgba(0, 20, 40, 0.95);
            --nav-bg: #001428;
            --border-accent: #0080FF;
            --input-bg: #002244;
        }

        [data-theme="sakura-blossom"] {
            --primary: #FFB6C1;
            --primary-dark: #FF69B4;
            --secondary: #FFD700;
            --card-bg: #3D2525;
            --sidebar-bg: #2D1B1B;
            --gradient-start: #1A0F0F;
            --gradient-end: #3D2525;
            --header-bg: rgba(61, 37, 37, 0.95);
            --nav-bg: #3D2525;
            --border-accent: #FFB6C1;
            --input-bg: #4D3535;
        }

        [data-theme="arctic-frost"] {
            --primary: #2C3E50;
            --primary-dark: #1A252F;
            --secondary: #3498DB;
            --dark: #FFFFFF;
            --darker: #F8F9FA;
            --light: #2C3E50;
            --text: #2C3E50;
            --text-muted: #7F8C8D;
            --card-bg: #FFFFFF;
            --sidebar-bg: #F8F9FA;
            --gradient-start: #FFFFFF;
            --gradient-end: #ECF0F1;
            --header-bg: rgba(255, 255, 255, 0.95);
            --nav-bg: #FFFFFF;
            --border-accent: #2C3E50;
            --input-bg: #ECF0F1;
        }

        [data-theme="volcanic-ash"] {
            --primary: #757575;
            --primary-dark: #424242;
            --secondary: #FF5722;
            --card-bg: #424242;
            --sidebar-bg: #212121;
            --gradient-start: #000000;
            --gradient-end: #424242;
            --header-bg: rgba(66, 66, 66, 0.95);
            --nav-bg: #424242;
            --border-accent: #757575;
            --input-bg: #616161;
        }

        /* Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Admin Layout */
        .admin-wrapper {
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        .admin-sidebar {
            width: 280px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-accent);
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .admin-sidebar.collapsed {
            width: 80px;
        }

        .sidebar-header {
            padding: 1.5rem;
            background: var(--header-bg);
            border-bottom: 1px solid var(--border-accent);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .admin-sidebar.collapsed .sidebar-logo span {
            display: none;
        }

        .sidebar-toggle {
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .sidebar-toggle:hover {
            background: var(--card-bg);
        }

        /* Sidebar Navigation */
        .sidebar-nav {
            flex: 1;
            overflow-y: auto;
            padding: 1rem 0;
        }

        .nav-item {
            display: block;
            padding: 1rem 1.5rem;
            color: var(--text);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-item:hover {
            background: var(--card-bg);
            color: var(--primary);
        }

        .nav-item.active {
            background: var(--card-bg);
            color: var(--primary);
            border-left: 3px solid var(--primary);
        }

        .nav-item i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .admin-sidebar.collapsed .nav-item span {
            display: none;
        }

        .admin-sidebar.collapsed .nav-item {
            justify-content: center;
            padding: 1rem;
        }

        /* Main Content */
        .admin-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Admin Header */
        .admin-header {
            background: var(--header-bg);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border-accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .page-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Header Actions */
        .header-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-accent);
            color: var(--text);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .header-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Theme Switcher */
        .theme-switcher {
            position: relative;
            z-index: 9998;
        }

        .theme-dropdown {
            position: fixed;
            top: auto;
            right: 2rem;
            background: var(--card-bg);
            border: 1px solid var(--border-accent);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 0.5rem;
            width: 320px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none;
            z-index: 10000;
        }

        .theme-dropdown.active {
            display: block;
        }

        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .theme-option {
            padding: 0.75rem;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .theme-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .theme-option.active {
            border-color: var(--primary);
            background: rgba(255, 107, 107, 0.1);
        }

        .theme-preview {
            display: flex;
            gap: 4px;
        }

        .theme-preview span {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 1px solid rgba(255,255,255,0.2);
        }

        /* Admin Content */
        .admin-content {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Stats Card */
        .stats-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid var(--border-accent);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: var(--primary);
            opacity: 0.1;
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .stats-icon {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin-bottom: 1rem;
        }

        .stats-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .stats-label {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .stats-change {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .stats-change.positive {
            background: rgba(46, 204, 113, 0.2);
            color: var(--success);
        }

        .stats-change.negative {
            background: rgba(231, 76, 60, 0.2);
            color: var(--danger);
        }

        /* Chart Container */
        .chart-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid var(--border-accent);
            margin-bottom: 2rem;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .chart-actions {
            display: flex;
            gap: 0.5rem;
        }

        .chart-btn {
            background: var(--input-bg);
            border: none;
            color: var(--text);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .chart-btn:hover {
            background: var(--primary);
            color: white;
        }

        .chart-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Live Orders */
        .live-orders {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid var(--border-accent);
        }

        .orders-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .orders-title {
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .live-indicator {
            width: 10px;
            height: 10px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* Orders Table */
        .orders-table {
            width: 100%;
            border-collapse: collapse;
        }

        .orders-table th {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 2px solid var(--border-accent);
            color: var(--text-muted);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .orders-table td {
            padding: 1rem 0.75rem;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .orders-table tr:hover {
            background: rgba(255,255,255,0.02);
        }

        .order-id {
            font-weight: 600;
            color: var(--primary);
        }

        .order-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .order-status.new {
            background: rgba(52, 152, 219, 0.2);
            color: var(--info);
        }

        .order-status.preparing {
            background: rgba(241, 196, 15, 0.2);
            color: var(--warning);
        }

        .order-status.ready {
            background: rgba(46, 204, 113, 0.2);
            color: var(--success);
        }

        .order-status.completed {
            background: rgba(149, 165, 166, 0.2);
            color: var(--text-muted);
        }

        .order-actions {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: var(--input-bg);
            color: var(--primary);
        }

        /* Quick Actions */
        .quick-actions {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid var(--border-accent);
            margin-bottom: 2rem;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .quick-action {
            background: var(--input-bg);
            border: 1px solid var(--border-accent);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: var(--text);
        }

        .quick-action:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .quick-action i {
            font-size: 2rem;
            margin-bottom: 0.75rem;
            display: block;
        }

        .quick-action span {
            font-size: 0.95rem;
            font-weight: 500;
        }

        /* Notifications */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
        }

        /* User Menu */
        .user-menu {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--card-bg);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            position: relative;
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--card-bg);
            border: 1px solid var(--border-accent);
            border-radius: 12px;
            padding: 0.5rem;
            margin-top: 0.5rem;
            width: 200px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
        }

        .user-dropdown.active {
            display: block;
        }

        .dropdown-item {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .dropdown-item:hover {
            background: var(--input-bg);
            color: var(--primary);
        }

        .dropdown-divider {
            height: 1px;
            background: var(--border-accent);
            margin: 0.5rem 0;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-muted);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--input-bg);
            border-top-color: var(--primary);
            border-radius: 50%;
            margin: 0 auto 1rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .admin-sidebar {
                position: fixed;
                left: -280px;
                height: 100vh;
                z-index: 1000;
            }

            .admin-sidebar.mobile-open {
                left: 0;
            }

            .admin-main {
                width: 100%;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .admin-content {
                padding: 1rem;
            }

            .header-left {
                gap: 1rem;
            }

            .page-title {
                font-size: 1.2rem;
            }

            .stats-value {
                font-size: 1.5rem;
            }

            .actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .orders-table {
                font-size: 0.9rem;
            }

            .orders-table th,
            .orders-table td {
                padding: 0.5rem;
            }
        }
    </style>
</head>
<body data-theme="noir-excellence">
    <div class="admin-wrapper">
        <!-- Sidebar -->
        <aside class="admin-sidebar" id="adminSidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i class="fas fa-fire"></i>
                    <span>Eatech</span>
                </div>
                <button class="sidebar-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Bestellungen</span>
                    <span class="notification-badge">3</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-box"></i>
                    <span>Produkte</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-users"></i>
                    <span>Kunden</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-chart-line"></i>
                    <span>Analytics</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-euro-sign"></i>
                    <span>Finanzen</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-bullhorn"></i>
                    <span>Marketing</span>
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span>Einstellungen</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Header -->
            <header class="admin-header">
                <div class="header-left">
                    <button class="header-btn mobile-menu" onclick="toggleMobileSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">Dashboard</h1>
                </div>
                
                <div class="header-right">
                    <div class="theme-switcher">
                        <button class="header-btn" onclick="toggleThemeDropdown()">
                            <i class="fas fa-palette"></i>
                            <span>Theme</span>
                        </button>
                        
                        <div class="theme-dropdown" id="themeDropdown">
                            <div class="theme-grid">
                                <div class="theme-option active" onclick="setTheme('noir-excellence')">
                                    <div class="theme-preview">
                                        <span style="background: #FF6B6B"></span>
                                        <span style="background: #1a1a2e"></span>
                                    </div>
                                    <span>Noir Excellence</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('midnight-purple')">
                                    <div class="theme-preview">
                                        <span style="background: #9B59B6"></span>
                                        <span style="background: #2C2C54"></span>
                                    </div>
                                    <span>Midnight Purple</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('forest-green')">
                                    <div class="theme-preview">
                                        <span style="background: #27AE60"></span>
                                        <span style="background: #1D3E2C"></span>
                                    </div>
                                    <span>Forest Green</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('ocean-blue')">
                                    <div class="theme-preview">
                                        <span style="background: #3498DB"></span>
                                        <span style="background: #1C2E4A"></span>
                                    </div>
                                    <span>Ocean Blue</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('sunset-orange')">
                                    <div class="theme-preview">
                                        <span style="background: #E67E22"></span>
                                        <span style="background: #3E2723"></span>
                                    </div>
                                    <span>Sunset Orange</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('royal-gold')">
                                    <div class="theme-preview">
                                        <span style="background: #F1C40F"></span>
                                        <span style="background: #3D3A2B"></span>
                                    </div>
                                    <span>Royal Gold</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('deep-space')">
                                    <div class="theme-preview">
                                        <span style="background: #0080FF"></span>
                                        <span style="background: #001428"></span>
                                    </div>
                                    <span>Deep Space</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('sakura-blossom')">
                                    <div class="theme-preview">
                                        <span style="background: #FFB6C1"></span>
                                        <span style="background: #3D2525"></span>
                                    </div>
                                    <span>Sakura Blossom</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('arctic-frost')">
                                    <div class="theme-preview">
                                        <span style="background: #2C3E50"></span>
                                        <span style="background: #FFFFFF"></span>
                                    </div>
                                    <span>Arctic Frost</span>
                                </div>
                                
                                <div class="theme-option" onclick="setTheme('volcanic-ash')">
                                    <div class="theme-preview">
                                        <span style="background: #757575"></span>
                                        <span style="background: #424242"></span>
                                    </div>
                                    <span>Volcanic Ash</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="header-btn" onclick="syncData()">
                        <i class="fas fa-sync"></i>
                        <span>Sync</span>
                    </button>
                    
                    <button class="header-btn" onclick="exportData()">
                        <i class="fas fa-download"></i>
                        <span>Export</span>
                    </button>
                    
                    <div class="user-menu" onclick="toggleUserDropdown()">
                        <div class="user-avatar">A</div>
                        <span>Admin</span>
                        <i class="fas fa-chevron-down"></i>
                        
                        <div class="user-dropdown" id="userDropdown">
                            <a href="#" class="dropdown-item">
                                <i class="fas fa-user"></i> Profil
                            </a>
                            <a href="#" class="dropdown-item">
                                <i class="fas fa-cog"></i> Einstellungen
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" onclick="logout()">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </a>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content -->
            <div class="admin-content">
                <!-- Stats Grid -->
                <div class="dashboard-grid">
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="stats-value" id="todayOrders">0</div>
                        <div class="stats-label">Bestellungen heute</div>
                        <span class="stats-change positive">+12.5%</span>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon" style="background: var(--success);">
                            <i class="fas fa-euro-sign"></i>
                        </div>
                        <div class="stats-value" id="todayRevenue">CHF 0</div>
                        <div class="stats-label">Umsatz heute</div>
                        <span class="stats-change positive">+8.3%</span>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon" style="background: var(--warning);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stats-value" id="todayCustomers">0</div>
                        <div class="stats-label">Kunden heute</div>
                        <span class="stats-change positive">+5.7%</span>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon" style="background: var(--info);">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stats-value" id="avgWaitTime">5 Min</div>
                        <div class="stats-label">Ã Wartezeit</div>
                        <span class="stats-change negative">-2 Min</span>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h3 style="margin-bottom: 1rem;">Schnellzugriff</h3>
                    <div class="actions-grid">
                        <a href="#" class="quick-action">
                            <i class="fas fa-plus-circle"></i>
                            <span>Neue Bestellung</span>
                        </a>
                        <a href="#" class="quick-action">
                            <i class="fas fa-box"></i>
                            <span>Produkt hinzufÃ¼gen</span>
                        </a>
                        <a href="#" class="quick-action">
                            <i class="fas fa-percentage"></i>
                            <span>Rabatt erstellen</span>
                        </a>
                        <a href="#" class="quick-action">
                            <i class="fas fa-chart-bar"></i>
                            <span>Bericht anzeigen</span>
                        </a>
                        <a href="#" class="quick-action">
                            <i class="fas fa-bell"></i>
                            <span>Benachrichtigung</span>
                        </a>
                        <a href="#" class="quick-action">
                            <i class="fas fa-tools"></i>
                            <span>Wartungsmodus</span>
                        </a>
                    </div>
                </div>

                <!-- Revenue Chart -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Umsatzentwicklung</h3>
                        <div class="chart-actions">
                            <button class="chart-btn active" onclick="updateChart('week')">Woche</button>
                            <button class="chart-btn" onclick="updateChart('month')">Monat</button>
                            <button class="chart-btn" onclick="updateChart('year')">Jahr</button>
                        </div>
                    </div>
                    <div style="position: relative; height: 250px;">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>

                <!-- Live Orders -->
                <div class="live-orders">
                    <div class="orders-header">
                        <h3 class="orders-title">
                            <span class="live-indicator"></span>
                            Live Bestellungen
                        </h3>
                        <button class="header-btn" onclick="refreshOrders()">
                            <i class="fas fa-sync"></i>
                        </button>
                    </div>
                    
                    <table class="orders-table">
                        <thead>
                            <tr>
                                <th>Bestellung</th>
                                <th>Kunde</th>
                                <th>Artikel</th>
                                <th>Betrag</th>
                                <th>Status</th>
                                <th>Zeit</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            <tr>
                                <td colspan="7" class="loading">
                                    <div class="spinner"></div>
                                    <p>Lade Bestellungen...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDFBlgWE81iHnACVwOmaU0jL7FV0l_tRmU",
            authDomain: "eatech-foodtruck.firebaseapp.com",
            databaseURL: "https://eatech-foodtruck-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "eatech-foodtruck",
            storageBucket: "eatech-foodtruck.firebasestorage.app",
            messagingSenderId: "261222802445",
            appId: "1:261222802445:web:edde22580422fbced22144",
            measurementId: "G-N0KHWJG9KP"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Global Variables
        let revenueChart = null;
        let currentTheme = localStorage.getItem('eatechTheme') || 'noir-excellence';

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Admin Dashboard loaded');
            
            // Load saved theme
            setTheme(currentTheme, false);
            
            // Initialize components
            initializeCharts();
            loadDashboardData();
            loadLiveOrders();
            
            // Start real-time updates
            startRealtimeUpdates();
        });

        // Toggle Sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('adminSidebar');
            sidebar.classList.toggle('collapsed');
        }

        // Toggle Mobile Sidebar
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('adminSidebar');
            sidebar.classList.toggle('mobile-open');
        }

        // Toggle Theme Dropdown
        function toggleThemeDropdown() {
            const dropdown = document.getElementById('themeDropdown');
            const button = event.currentTarget;
            const rect = button.getBoundingClientRect();
            
            if (dropdown.classList.contains('active')) {
                dropdown.classList.remove('active');
            } else {
                // Position dropdown
                dropdown.style.position = 'fixed';
                dropdown.style.top = (rect.bottom + 10) + 'px';
                dropdown.style.right = (window.innerWidth - rect.right) + 'px';
                dropdown.classList.add('active');
            }
        }

        // Set Theme
        function setTheme(themeName, save = true) {
            document.body.setAttribute('data-theme', themeName);
            currentTheme = themeName;
            
            // Update active state
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
                if (option.getAttribute('onclick').includes(themeName)) {
                    option.classList.add('active');
                }
            });
            
            // Save to localStorage
            if (save) {
                localStorage.setItem('eatechTheme', themeName);
                showNotification('Theme geÃ¤ndert zu ' + themeName.replace('-', ' '));
            }
            
            // Close dropdown
            document.getElementById('themeDropdown').classList.remove('active');
        }

        // Toggle User Dropdown
        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('active');
        }

        // Initialize Charts
        function initializeCharts() {
            const ctx = document.getElementById('revenueChart').getContext('2d');
            
            // Get theme colors
            const computedStyle = getComputedStyle(document.body);
            const primaryColor = computedStyle.getPropertyValue('--primary').trim();
            const secondaryColor = computedStyle.getPropertyValue('--secondary').trim();
            const textColor = computedStyle.getPropertyValue('--text').trim();
            const gridColor = currentTheme === 'arctic-frost' ? '#E0E0E0' : 'rgba(255,255,255,0.1)';
            
            revenueChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'],
                    datasets: [{
                        label: 'Umsatz',
                        data: [1200, 1900, 1500, 2100, 2400, 2800, 2200],
                        borderColor: primaryColor,
                        backgroundColor: `${primaryColor}20`,
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Vorwoche',
                        data: [1000, 1700, 1400, 1900, 2200, 2500, 2000],
                        borderColor: secondaryColor,
                        backgroundColor: `${secondaryColor}20`,
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        borderDash: [5, 5]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                color: textColor,
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            padding: 12,
                            cornerRadius: 8,
                            displayColors: true
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: gridColor,
                                drawBorder: false
                            },
                            ticks: {
                                color: textColor,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        y: {
                            grid: {
                                color: gridColor,
                                drawBorder: false
                            },
                            ticks: {
                                color: textColor,
                                font: {
                                    size: 11
                                },
                                callback: function(value) {
                                    return 'CHF ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        // Load Dashboard Data
        async function loadDashboardData() {
            try {
                const today = new Date().toISOString().split('T')[0];
                
                // Load orders
                const ordersSnapshot = await db.ref('orders').orderByChild('createdAt').startAt(today).once('value');
                const orders = ordersSnapshot.val() || {};
                
                let totalOrders = 0;
                let totalRevenue = 0;
                const customers = new Set();
                
                Object.values(orders).forEach(order => {
                    totalOrders++;
                    totalRevenue += order.pricing?.total || order.total || 0;
                    if (order.customer?.phone) {
                        customers.add(order.customer.phone);
                    }
                });
                
                // Update UI
                document.getElementById('todayOrders').textContent = totalOrders;
                document.getElementById('todayRevenue').textContent = `CHF ${totalRevenue.toFixed(2)}`;
                document.getElementById('todayCustomers').textContent = customers.size;
                
                // Load average wait time
                const waitTimeSnapshot = await db.ref('settings/waitTime').once('value');
                const waitTime = waitTimeSnapshot.val() || 5;
                document.getElementById('avgWaitTime').textContent = `${waitTime} Min`;
                
            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        // Load Live Orders
        async function loadLiveOrders() {
            try {
                const ordersSnapshot = await db.ref('orders').limitToLast(10).once('value');
                const orders = ordersSnapshot.val() || {};
                
                const tbody = document.getElementById('ordersTableBody');
                tbody.innerHTML = '';
                
                const ordersArray = Object.entries(orders).reverse();
                
                if (ordersArray.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 2rem; color: var(--text-muted);">
                                Keine Bestellungen vorhanden
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                ordersArray.forEach(([orderId, order]) => {
                    const row = createOrderRow(orderId, order);
                    tbody.appendChild(row);
                });
                
            } catch (error) {
                console.error('Error loading orders:', error);
            }
        }

        // Create Order Row
        function createOrderRow(orderId, order) {
            const tr = document.createElement('tr');
            
            const time = new Date(order.createdAt || order.timestamp).toLocaleTimeString('de-CH', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            const itemCount = order.items?.reduce((sum, item) => sum + (item.quantity || 1), 0) || 0;
            
            tr.innerHTML = `
                <td class="order-id">#${orderId.slice(-6).toUpperCase()}</td>
                <td>${order.customer?.name || 'Gast'}</td>
                <td>${itemCount} Artikel</td>
                <td>CHF ${(order.pricing?.total || order.total || 0).toFixed(2)}</td>
                <td><span class="order-status ${order.status || 'new'}">${getStatusText(order.status)}</span></td>
                <td>${time}</td>
                <td>
                    <div class="order-actions">
                        <button class="action-btn" onclick="viewOrder('${orderId}')" title="Anzeigen">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="action-btn" onclick="updateOrderStatus('${orderId}')" title="Status Ã¤ndern">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn" onclick="printOrder('${orderId}')" title="Drucken">
                            <i class="fas fa-print"></i>
                        </button>
                    </div>
                </td>
            `;
            
            return tr;
        }

        // Get Status Text
        function getStatusText(status) {
            const statusMap = {
                'new': 'Neu',
                'preparing': 'In Zubereitung',
                'ready': 'Fertig',
                'completed': 'Abgeschlossen'
            };
            return statusMap[status] || status;
        }

        // Start Realtime Updates
        function startRealtimeUpdates() {
            // Listen for new orders
            db.ref('orders').on('child_added', (snapshot) => {
                const order = snapshot.val();
                const orderId = snapshot.key;
                
                // Show notification for new orders
                if (order.status === 'new') {
                    showNotification(`Neue Bestellung #${orderId.slice(-6).toUpperCase()}`, 'info');
                    playNotificationSound();
                }
                
                // Reload data
                loadDashboardData();
                loadLiveOrders();
            });
            
            // Listen for order updates
            db.ref('orders').on('child_changed', (snapshot) => {
                loadLiveOrders();
            });
        }

        // Update Chart
        function updateChart(period) {
            // Update active button
            document.querySelectorAll('.chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update chart data based on period
            let labels, data1, data2;
            
            switch(period) {
                case 'week':
                    labels = ['Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'];
                    data1 = [1200, 1900, 1500, 2100, 2400, 2800, 2200];
                    data2 = [1000, 1700, 1400, 1900, 2200, 2500, 2000];
                    break;
                case 'month':
                    labels = ['Woche 1', 'Woche 2', 'Woche 3', 'Woche 4'];
                    data1 = [12000, 14000, 13500, 15000];
                    data2 = [11000, 13000, 12500, 14000];
                    break;
                case 'year':
                    labels = ['Jan', 'Feb', 'MÃ¤r', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'];
                    data1 = [45000, 52000, 48000, 55000, 60000, 65000, 70000, 68000, 62000, 58000, 55000, 60000];
                    data2 = [42000, 48000, 45000, 52000, 56000, 60000, 65000, 64000, 58000, 54000, 52000, 56000];
                    break;
            }
            
            revenueChart.data.labels = labels;
            revenueChart.data.datasets[0].data = data1;
            revenueChart.data.datasets[1].data = data2;
            revenueChart.update();
        }

        // View Order
        function viewOrder(orderId) {
            console.log('View order:', orderId);
            // Implement order details modal
        }

        // Update Order Status
        function updateOrderStatus(orderId) {
            console.log('Update order status:', orderId);
            // Implement status update modal
        }

        // Print Order
        function printOrder(orderId) {
            console.log('Print order:', orderId);
            // Implement print functionality
        }

        // Refresh Orders
        function refreshOrders() {
            loadLiveOrders();
            showNotification('Bestellungen aktualisiert');
        }

        // Sync Data
        function syncData() {
            loadDashboardData();
            loadLiveOrders();
            showNotification('Daten synchronisiert');
        }

        // Export Data
        function exportData() {
            showNotification('Export gestartet...', 'info');
            // Implement export functionality
        }

        // Logout
        function logout() {
            if (confirm('MÃ¶chten Sie sich wirklich abmelden?')) {
                localStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminUsername');
                localStorage.removeItem('loginTime');
                window.location.href = 'admin.html';
            }
        }

        // Show Notification
        function showNotification(message, type = 'success') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `admin-notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'info' ? 'info-circle' : 'exclamation-circle'}"></i>
                <span>${message}</span>
            `;
            
            // Add styles
            notification.style.cssText = `
                position: fixed;
                bottom: 2rem;
                right: 2rem;
                background: ${type === 'success' ? 'var(--success)' : type === 'info' ? 'var(--info)' : 'var(--danger)'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                display: flex;
                align-items: center;
                gap: 0.75rem;
                z-index: 9999;
                animation: slideInRight 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            // Remove after delay
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Play Notification Sound
        function playNotificationSound() {
            const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSt+zPTXhjYGHGS56+2eSgwPTqzn77ViFAUWdL');
            audio.volume = 0.3;
            audio.play().catch(e => console.log('Audio play failed:', e));
        }

        // Add animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Close dropdowns on outside click
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.theme-switcher')) {
                document.getElementById('themeDropdown').classList.remove('active');
            }
            if (!e.target.closest('.user-menu')) {
                document.getElementById('userDropdown').classList.remove('active');
            }
        });
    </script>
</body>
</html>