<!DOCTYPE html>
<html lang="de-CH">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EATECH - Offline</title>
    <meta name="description" content="Sie sind momentan offline. EATECH funktioniert auch ohne Internetverbindung.">
    
    <style>
        /* üìç Dateipfad: public/offline.html */
        
        :root {
            /* Noir Excellence Theme Colors */
            --primary: #FF6B6B;
            --primary-dark: #FF5252;
            --secondary: #4ECDC4;
            --accent: #FFE66D;
            --bg-primary: #0A0A0A;
            --bg-secondary: #141414;
            --bg-card: #1A1A1A;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --gradient-primary: linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 100%);
            --shadow-lg: 0 20px 60px rgba(255, 107, 107, 0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        
        /* Animated background */
        body::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 20% 50%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(78, 205, 196, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 20%, rgba(255, 230, 109, 0.05) 0%, transparent 50%);
            animation: float 20s infinite ease-in-out;
        }
        
        @keyframes float {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            33% {
                transform: translate(30px, -30px) rotate(120deg);
            }
            66% {
                transform: translate(-20px, 20px) rotate(240deg);
            }
        }
        
        .offline-container {
            text-align: center;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            position: relative;
            z-index: 1;
        }
        
        .offline-icon {
            width: 120px;
            height: 120px;
            margin: 0 auto 2rem;
            position: relative;
            animation: pulse 2s infinite ease-in-out;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(0.95);
                opacity: 0.8;
            }
        }
        
        .offline-icon svg {
            width: 100%;
            height: 100%;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .offline-message {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: 3rem;
            line-height: 1.6;
        }
        
        .offline-features {
            background: var(--bg-card);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .offline-features h2 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--primary);
        }
        
        .feature-list {
            display: grid;
            gap: 1rem;
            text-align: left;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .feature-item:hover {
            transform: translateX(5px);
            background: rgba(255, 107, 107, 0.1);
        }
        
        .feature-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .feature-icon svg {
            width: 20px;
            height: 20px;
            fill: white;
        }
        
        .feature-text h3 {
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }
        
        .feature-text p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            border: none;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-secondary:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }
        
        .connection-status {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem;
            background: var(--bg-card);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: var(--shadow-lg);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        
        .connection-status.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #FF5252;
            animation: blink 2s infinite;
        }
        
        .status-indicator.online {
            background: #00E676;
            animation: none;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        /* Loading animation */
        .loader {
            display: none;
            width: 40px;
            height: 40px;
            border: 3px solid var(--bg-secondary);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Mobile optimization */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .offline-message {
                font-size: 1.1rem;
            }
            
            .action-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .connection-status {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="offline-container">
        <!-- Offline Icon -->
        <div class="offline-icon">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8z" fill="#FF6B6B"/>
            </svg>
        </div>
        
        <h1>Sie sind offline</h1>
        
        <p class="offline-message">
            Keine Sorge! EATECH funktioniert auch ohne Internetverbindung. 
            Ihre Daten werden automatisch synchronisiert, sobald Sie wieder online sind.
        </p>
        
        <div class="offline-features">
            <h2>Das k√∂nnen Sie offline tun:</h2>
            <div class="feature-list">
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"/>
                        </svg>
                    </div>
                    <div class="feature-text">
                        <h3>Speisekarte durchsuchen</h3>
                        <p>Alle Produkte und Preise sind verf√ºgbar</p>
                    </div>
                </div>
                
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
                        </svg>
                    </div>
                    <div class="feature-text">
                        <h3>Warenkorb verwalten</h3>
                        <p>Artikel hinzuf√ºgen und entfernen</p>
                    </div>
                </div>
                
                <div class="feature-item">
                    <div class="feature-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                    <div class="feature-text">
                        <h3>Bestellungen vorbereiten</h3>
                        <p>Werden gesendet, sobald Sie online sind</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="action-buttons">
            <button onclick="tryReconnect()" class="btn btn-primary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
                    <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
                </svg>
                Erneut versuchen
            </button>
            <a href="/" class="btn btn-secondary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
                Zur Startseite
            </a>
        </div>
        
        <div class="loader" id="reconnectLoader"></div>
    </div>
    
    <!-- Connection Status Indicator -->
    <div class="connection-status" id="connectionStatus">
        <div class="status-indicator" id="statusIndicator"></div>
        <span id="statusText">Offline</span>
    </div>
    
    <script>
        // Check online status
        function checkConnection() {
            const statusEl = document.getElementById('connectionStatus');
            const indicatorEl = document.getElementById('statusIndicator');
            const textEl = document.getElementById('statusText');
            
            if (navigator.onLine) {
                indicatorEl.classList.add('online');
                textEl.textContent = 'Online';
                
                // Redirect to home after 2 seconds
                setTimeout(() => {
                    window.location.href = '/';
                }, 2000);
            } else {
                indicatorEl.classList.remove('online');
                textEl.textContent = 'Offline';
            }
            
            statusEl.classList.add('show');
        }
        
        // Try to reconnect
        function tryReconnect() {
            const loader = document.getElementById('reconnectLoader');
            loader.style.display = 'block';
            
            // Check connection
            fetch('/api/ping', { method: 'HEAD' })
                .then(() => {
                    // Success - we're online
                    window.location.href = '/';
                })
                .catch(() => {
                    // Still offline
                    loader.style.display = 'none';
                    showNotification('Immer noch offline. Bitte versuchen Sie es sp√§ter erneut.');
                });
        }
        
        // Show notification
        function showNotification(message) {
            // Create toast notification
            const toast = document.createElement('div');
            toast.className = 'toast-notification';
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                top: 2rem;
                left: 50%;
                transform: translateX(-50%);
                background: var(--bg-card);
                color: var(--text-primary);
                padding: 1rem 2rem;
                border-radius: 0.5rem;
                box-shadow: var(--shadow-lg);
                z-index: 1000;
                animation: slideDown 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
        
        // Service Worker registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.ready.then(registration => {
                console.log('Service Worker ready');
            });
        }
        
        // Listen for online/offline events
        window.addEventListener('online', () => {
            checkConnection();
            showNotification('Verbindung wiederhergestellt!');
        });
        
        window.addEventListener('offline', () => {
            checkConnection();
        });
        
        // Initial check
        checkConnection();
        
        // Cache status for offline features
        const offlineData = {
            cartItems: localStorage.getItem('eatech_cart') || '[]',
            lastSync: localStorage.getItem('eatech_last_sync') || null,
            pendingOrders: localStorage.getItem('eatech_pending_orders') || '[]'
        };
        
        console.log('Offline data:', offlineData);
    </script>
</body>
</html>